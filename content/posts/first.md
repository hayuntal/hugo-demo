+++

title = "איסוף נתוני פיקוד העורף - חרבות ברזל"
date = "2024-10-07T14:15:45+03:00"
draft = false
rtl = true
summary = """
בשנה האחרונה נורו עשרות אלפיי רקטות למדינת ישראל, מצפון ועד דרום.

במאמר זה אספר על תהליך איסוף הנתונים ותובנות שהתקבלו.
"""

[cover]
    image = "img/red_alert.PNG"
    alt = "This is a post image"
+++

## מבוא
בשביעי באוקטובר, החל מלחמה שהשפיעה עמוקות על כולנו. רצף של אזעקות ודיווחים רבים בחדשות הטיל חוסר ודאות ובלבול גדול בקרב האזרחים. בתחילה, לא חשבתי שאתעסק בפרויקט נרחב שיתמקד בניתוח רצף האזעקות, אך שבועיים לאחר תחילת המלחמה, החלטתי לקחת על עצמי את המשימה ולבנות דשבורד מקיף שיציג את נתוני האזעקות ברחבי הארץ. הדשבורד שבניתי מפורט אך נגיש לכל משתמש באינטרנט, עם מטרה להנגיש נתונים שיעזרו לתושבים להחליט:
 - מתי הזמן הטוב ביותר להוציא את הכלב לטיול.
- מתי מומלץ לצאת לעבודה.
- איזו דרך הכי טובה לנסוע לביקור אצל ההורים.
- באיזה שעה כדאי לתכנן פעילויות יומיומיות כמו להתקלח ועוד.

הדשבורד נוצר במטרה להעניק שקט נפשי וביטחון למשתמשים, שידעו שיש להם כלי שיעזור להם לנהל את חייהם בימים לא פשוטים אלה. בנוסף, המידע מוצג באופן שמתאים גם למומחים וגם לציבור הרחב, תוך שימוש בנתונים גרפיים ותרשימים שמסבירים את המציאות בצורה ברורה ומובנת.

בואו נצלול לתהליך איסוף הנתונים.

## איסוף הנתונים

איסוף הנתונים התחלק ל-2 חלקים מרכזים:

- אוקטובר 23 - יוני 24
- יוני 24 - היום

### אוקטובר 23 - יוני 24 
בתקופה זו, פוקסנו בפרויקט על איסוף נתונים ועל שיפור אמינות המידע שנאסף. האתגר העיקרי היה לפתח וליישם מערכת יעילה, אשר תוכל לקלוט נתונים ממקורות מידע אמינים ולעבד אותם במהירות גבוהה.

איסוף הנתונים נעשה באמצעות URL של אתר פיקוד העורף הרשמי, שם פורסמו נתוני האזעקות בפורמט תגיות קוד, כל אזעקה  עטופה כך:
```json
{Location: "Zikim", Date: "07/10/2023", Time: "06:29:00", AlertDate: "2023-10-07T06:29:00", Category: "1", CategoryDesc: "Missiles"}
```
פורמט זה מאפשר זיהוי ברור ומדויק של האזעקות, תאריכים, וסוגי האיומיום. 


####  מגבלת 2000 אזעקות ליום 

כפי שניתן לראות באתר פיקוד העורף, קיימת מגבלה של 2000 אזעקות ליום. כלומר, תאריכים בהם קיימים מעל 2000 אזעקות יציגו רק את האחרונות שהופעלו.
התאריך היחיד בו נרשמו כמות אזעקות כזו גבוהה היה ה-7 באוקטובר, עם סה"כ של 4053 אזעקות.

**התמודדות**  
לאחר חקר מעמיק והבנת המבנה של ה-URL נוכחתי לגלות כי ניתן לשנות מס' תווים בכתובת ה-URL על מנת לקבל מידע ספציפי יותר,
ובהם:
- טווח תאריכים
- מיקום
- סוגי התראות

כפי שציינתי, התאריך היחיד בו נרשמו מעל 2000 אזעקות היה ה-7 באוקטובר לכן, זה יהיה הערך בטווח התאריכים (תאריך התחלתי ותאריך סופי): 
```json
fromDate=07.10.2023&toDate=07.10.2023
```
בנוסף, היה חשוב לזהות באילו מקומות הופעלה אזעקה באותו היום. מאחר והתחלתי את הפרויקט כשבועיים לאחר תחילת המלחמה, הייתה לי האפשרות לחלץ את כל המיקומים שבהם הופעלו אזעקות עד אותו היום.
עברתי באופן איטרטיבי (סדרתי) על כל המיקומים בשבועיים אלו, ושמרתי אותם במשתנה מטיפוס רשימה בשם `locations`, תוך שימוש בפונקציית `set` המאפשרת שמירת ערכים ברשימה ללא כפילות. 

בשלב זה, השתמשתחי בלואת `FOR` פשוטה, כך שבכל איטרציה (פעולה סדרתית) הכנסתי את שם המקום לשדה המיקום:
```json
city_name=Sderot
```

לאחר פקודה זו, קיבלתי את כלל האזעקות בכל מיקום בשביעי באוקטובר, ובכך עקפתי את הגבלת ה-2000 אזעקות.

דוגמה לכתובת URL מלאה:

```json
https://oref.org.il//Shared/Ajax/GetAlarmsHistory.aspx?lang=en&fromDate=07.10.2023&toDate=07.10.2023&mode=0&city_name=Sderot
```

כפי שניתן לראות, ניתן גם לשנות את שמות הערכים לעברית  (וגם לרוסית) ע"י שינוי הערך בשדה `lang`.

#### ביטול האפשרות לקבלת מידע האזעקות באמצעות ה-URL של פיקוד העורף 
בתחילת אפריל - נחסמה האפשרות לקבלת מידע האזעקות כפי שעשיתי עד כה. קבלת שגיאת 404 במקום מידע רלוונטי המכיל את נתוני האזעקות.




### יוני 24 - היום